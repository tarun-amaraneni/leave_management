{% extends "base.html" %}

{% block title %}Leave Calendar{% endblock %}

{% block extra_css %}
<style>
/* ===== Page Heading ===== */
.main h2 {
    font-size: 30px;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 22px;
    text-align: center;
}

/* ===== Calendar Card ===== */
.calendar-container {
    max-width: 1050px;
    margin: 0 auto;
    padding: 26px;
    background: linear-gradient(180deg, #ffffff, #f9fafb);
    border-radius: 18px;
    box-shadow: 0 18px 40px rgba(0,0,0,0.08);
}

/* ===== Navigation ===== */
.nav-buttons {
    display: flex;
    justify-content: center;
    gap: 14px;
    margin-bottom: 14px;
}

.nav-buttons a {
    font-size: 14px;
    padding: 8px 20px;
    border-radius: 999px;
    text-decoration: none;
    border: 1px solid #4CAF50;
    color: #4CAF50;
    font-weight: 600;
    transition: all 0.25s ease;
    background: #fff;
}

.nav-buttons a:hover {
    background-color: #4CAF50;
    color: #fff;
    transform: translateY(-1px);
    box-shadow: 0 6px 15px rgba(76,175,80,0.3);
}

/* ===== Month Title ===== */
.calendar-container h2 {
    text-align: center;
    margin: 10px 0 18px;
    font-size: 22px;
    font-weight: 700;
    color: #111827;
}

/* ===== Legend ===== */
.legend {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 22px;
    margin-bottom: 22px;
    font-size: 14px;
    font-weight: 500;
}

.legend div {
    display: flex;
    align-items: center;
    gap: 6px;
}

.legend span {
    width: 14px;
    height: 14px;
    border-radius: 4px;
}

.legend .approved { background: #22c55e; }
.legend .pending { background: #facc15; }
.legend .rejected { background: #ef4444; }

/* ===== Calendar Table ===== */
.calendar {
    width: 100%;
    table-layout: fixed;
    border-collapse: separate;
    border-spacing: 0;
    overflow: hidden;
    border-radius: 14px;
}

.calendar th {
    background: linear-gradient(135deg, #4CAF50, #43a047);
    color: #fff;
    font-size: 13px;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    padding: 14px 6px;
    text-align: center;
}

.calendar td {
    border: 1px solid #e5e7eb;
    height: 110px;
    padding: 8px;
    vertical-align: top;
    background: #fff;
    transition: background 0.2s ease;
}

.calendar td:hover {
    background: #f9fafb;
}

/* ===== Other Month ===== */
.other-month {
    background: #f3f4f6;
    color: #9ca3af;
    text-align: center;
    font-weight: 500;
}

/* ===== Day Number ===== */
.calendar td strong {
    display: inline-block;
    font-size: 13px;
    font-weight: 700;
    color: #374151;
    margin-bottom: 4px;
}

/* ===== Leave Badges ===== */
.leave {
    display: inline-block;
    margin-top: 4px;
    padding: 4px 8px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
    line-height: 1;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    white-space: nowrap;
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
}

.leave:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.12);
}

/* Status Colors */
.leave.approved {
    background: #22c55e;
    color: #fff;
}
.leave.pending {
    background: #facc15;
    color: #111827;
}
.leave.rejected {
    background: #ef4444;
    color: #fff;
}

/* ===== Responsive ===== */
@media (max-width: 768px) {
    .calendar td {
        height: 85px;
        padding: 6px;
    }

    .calendar th {
        font-size: 11px;
        padding: 10px 4px;
    }

    .leave {
        font-size: 10px;
        padding: 3px 6px;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="calendar-container">

    <!-- Navigation -->
    <div class="nav-buttons">
        <a href="{% url 'leave_calendar' year=prev_year month=prev_month %}">
            &laquo; Previous
        </a>
        <a href="{% url 'leave_calendar' year=next_year month=next_month %}">
            Next &raquo;
        </a>
    </div>

    <h2>Leave Calendar â€“ {{ month }}/{{ year }}</h2>

    <!-- Legend -->
    <div class="legend">
        <div><span class="approved"></span> Approved</div>
        <div><span class="pending"></span> Pending</div>
        <div><span class="rejected"></span> Rejected</div>
    </div>

    <!-- Calendar -->
    <table class="calendar">
        <thead>
            <tr>
                {% for day in weekdays %}
                    <th>{{ day }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for week in calendar_data %}
            <tr>
                {% for day in week %}
                    {% if day.date.month != month %}
                        <td class="other-month">{{ day.date.day }}</td>
                    {% else %}
                        <td>
                            <strong>{{ day.date.day }}</strong><br>
                            {% for leave in day.leaves %}
                                <span class="leave {{ leave.status|lower }}"
                                      title="{{ leave.employee.username }} | {{ leave.leave_type }} | {{ leave.status }}">
                                    {{ leave.employee.username }}
                                </span>
                            {% endfor %}
                        </td>
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

</div>
{% endblock %}
